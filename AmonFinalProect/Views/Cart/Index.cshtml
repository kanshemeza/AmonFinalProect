@model AmonFinalProect.Models.Carts
@{
    ViewData["Title"] = "Cart";
}

<h2>Cart</h2>
<div class="row">
    <div class="col-8">
        <h5>Shopping Cart</h5>
    </div>

    <div class="col-2">
        <h5 class="qp">Quantity</h5>
    </div>

    <div class="col-2">
        <h5 class="qp">Price</h5>
    </div>
</div>

<div class="row">

    @foreach (var item in Model.CartsProducts)
    {

        <div class="col-2">
            <img src="@item.Product.ImageUrl" alt="@item.Product.Name" class="img-fluid" style="max-width: 100%; height:auto; margin-bottom: 30px" />
        </div>
        <div class="col-6"></div>
        <div class="col-2">
            <p class="qp"> @item.Quantity</p>

        </div>
        <div class="col-2">
            <p class="qp">@(item.Product.Price.HasValue ? item.Product.Price.Value.ToString("c") : "No Price")</p>
        </div>

    }
</div>

<div class="row">
    <div class="col-8"></div>
    <div class="col-2">
        <h5 class="qp">Subtotal</h5>
    </div>
    <div class="col-2">
        <h5 class="qp">@Model.CartsProducts.Sum(x => (x.Product.Price ?? 0m) * x.Quantity).ToString("c")</h5>
    </div>
</div>

<button class="btn btn-primary checkout-button">Checkout</button>


@section scripts{
    <script type="text/javascript">
        $(".checkout-button").click(e => {
            //var id = $(e.target).siblings('.product').val();
            //var quantity = $(e.target).siblings('.quantity').val();
            //var instructions = $(e.target).siblings('.instructions').val();
            //$.post("/products", { id: id, quantity: quantity, instructions: instructions }, (d) => {
            //    window.location.href = "/Cart"
            //});
            window.location.href = "/Profile"


        })
    </script>
}

@*<div class="row">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Quantity</th>
                    <th>Price</th>
                </tr>
            </thead>
            @foreach (var item in Model.CartsProducts)
            {
                <tr>
                    <td>@item.Product.Name</td>
                    <td>
                        <form asp-action="update" asp-controller="cart" method="post" class="form-inline">
                            <input name="productId" value="@item.Product.Id" type="hidden" />
                            <input name="quantity" value="@item.Quantity" type="number" class="form-control-sm" /><input type="submit" value="Update Quantity" class="btn btn-primary" />
                        </form>
                    </td>
                    <td>@((item.Product.Price ?? 0m).ToString("c"))</td>
                </tr>
            }
            <tfoot>
                <tr>
                    <th colspan="2">Subtotal</th>
                    <th>@Model.CartsProducts.Sum(x => (x.Product.Price ?? 0m) * x.Quantity).ToString("c")</th>
                </tr>
            </tfoot>
        </table>
    </div>*@

